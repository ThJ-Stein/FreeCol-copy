language: java
jdk:
- openjdk12
env:
  matrix:
  - DSTAMP=$(date +%F)
  global:
    secure: "L1YpvxOJpcVPZf0locjXY0NfqHWAO/Xlexk5NJEIacxEq4XCvYupIPu/cbSCiVyWrpS6OktU4gzDkFoMs3DjR8A2PO4KHX+0Ec1tftkgg0y22l//gDm+Pe0NHa21Io7Xb025oRNWsY7wRf9kN+ahh4WpIR9VSh0A1BRielGZeS+5nBr1ey2PS4Qv9Z3vwvoNPDErFTkHjNfLQdHZLztbJsBGLYHwDYvdxNq+PTWGoOjqwPg1lymmtHYNue00Q4GVJnhODSHLj9S697gaSLGWAmOlUT1j1U5R9mIWjPfFi+Ha3r+XP6DkzG7PIpsnjG9uz2zUp6wiYS9/RNTRnLPOhymj5xoGJ+7bU5jdLnfBoR/TfyMbm9/wW5s5iGsucVcRQdl4OigMLeV3KHSIbCuAYaH/K7dqfHrf0O7T/4SZsiyRyNadeZfXGwL0V/TdnsHBGQBITDPGa0sY2fkMhYreCeRPQ83WnViCrgoGM2x1qJO5hMQJgkE91td1IN6iwK6pu1lIApSpD7O/wWqjFDS4ARu19lq3UvC+7d865Ro+L9dHO7h/spXhz7LguLQDhliGHv6QKYcjeKGVK6WZMoaie/8EzwSnnHY0hkRXWqeUkouKPNDKNLKsCfE03LIpdttXRK/lbxafTogRsbxb/FN4XGVIYY8FmERrldF2IVLOqaE="

before_install:
  - echo -n | openssl s_client -connect scan.coverity.com:443 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' | sudo tee -a /etc/ssl/certs/ca-
addons:
  apt:
    packages:
    - ant-optional
  coverity_scan:
    project:
      name: "ThJ-Stein/FreeCol-copy"
      description: "project to learn about automated CI/CD pipelines"
    notification_email: t.stouten@student.utwente.nl
    build_command: "ant nightly-release"
    branch_pattern: coverity_scan
script:
- ant testci
before_deploy:
- ant nightly-release
- ls -l dist/releases
deploy:
  provider: releases
  skip_cleanup: true
  tag_name: nightly-$DSTAMP
  prerelease: true
  name: 'Nightly Release: $DSTAMP'
  api_key:
    secure: "GiMJfutrdG+bGDtf1L9EFdo9dp1Gd0N7v4NbxaT7RRjy2Hj9Z6YLYzffvIZDowZNNhZ5KhA1nN16586gwxwZsbQPhxXJd9EZoXFaahLLekWxPjfu1Mb9T2D7jqL3oNr1E2IWC1dS2LXPnoHtMGE8CpBkyXokm5L0T5cWbS6sSeTTOlGbz31GawqtYf4kahzpLpok0zzrQsAVxIffnFvbe54qTcp4tDzI/7CarfBNpeB0Y34ZTuzqeUrPKR+vnCNUSqINxgX3usG9yY31BQa/SWQ+pAI1XiAf9bdw9eg7DkO9Z19jPzsTkgRd7FuVQVllfL8qjHpjsVxMNnJI/nmv2gVdYgPxLQpbzJ86Y1BwdLM0Bewvq41lCJyriKxMv9mNRByfNoZ3U3yJlqLS2k9985f1BZBZotDOovnG2az+4d1F07Af3nIlJfbVJaP6Z1flwtoABvhwF1JRTB21dV9q8LQ8eBZKoUHHWQwEMDjjO7eeT+sdtuFIzLetMk6DoRm2jzsvNiJlM3Kj+qoGPTpniU3q2wx+WKp3R6ZFZN0yLIPvF+KdFcqYvnn6ZFm9Q/2x8oblQ98xfEerbEgi/aH5gWJ550e0LO7G6bPMkN9k4hv18fFXdgaeZ7aSqdN+Fn6+GaKCwD+CL1haTAb7Czi6DQ7bdk1Rq+SNzvZ9og79a4I="
  file: dist/releases/*
  on:
    repo: ThJ-Stein/FreeCol-copy
    branch: master

